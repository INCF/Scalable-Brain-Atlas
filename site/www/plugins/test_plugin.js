function testMarker_class(label,origSlice,xySvg) {
  sbaMarker_class.apply(this,[label,origSlice,xySvg]);
}
testMarker_class.prototype = new sbaMarker_class();

testMarker_class.prototype.onclick = function(ev,dim) {
  var state = sbaViewer.getState();
  state.acr = this.label;
  state.origSlice = this.origSlice;
  sbaViewer.applyStateChange(state);
}

function testPlugin_class(name,sbaViewer) {
  sbaPlugin_class.apply(this,[name]);
  this.acr = null;
  this.brainMap = 'test';
  this.outgoingProjections = true;
}
testPlugin_class.prototype = new sbaPlugin_class();

testPlugin_class.prototype.activate = function(sbaViewer,divElem) {
  var sbaAcr = sbaViewer.currentAcr;
  if (sbaAcr != undefined) {
    this.acr = sbaAcr;
    // progress message
    divElem.innerHTML = '<b>Ipsilateral <select onchange="sbaPluginManager.getPlugin(\'test\').setDirection(this)"><option value="in">Incoming</option><option value="out" selected="1">Outgoing</option></select> projections for region '+this.acr+'</b><br/><a href="#metetal14_cite">terms of use</a>&#160;|&#160;<a href="#metetal14_about">about</a>&#160;|&#160;<a href="#metetal14_download">download</a><br/><br/><div id="SBA_CONNECTIVITY">...</div><p><a name="metetal14_about"/><b>About: </b>Connectivity data based on retrograde tracing studies described in the reference below. FLNe is the fraction of labelled neurons, excluding the injected region itself.</p><p><a name="metetal14_cite"/><b>Terms of use: </b>When using this data, cite: Markov NT, Ercsey-Ravasz MM, Ribeiro Gomes AR, et al. (2014) Cereb Cortex. 24(1):17-36, doi: <a href="http://dx.doi.org/10.1093/cercor/bhs270">10.1093/cercor/bhs270</a>.</p><p><a name="metetal14_download"></a><b>Downloads: </b>FLNe data as a <a href="../test_on_F99/source/flne_matrix_annotated.csv">comma separated matrix</a>. Check for updates at <a href="http://www.core-nets.org/">core-nets.org</a>.</p>';
    this.retrieveConnectivity(this.acr);
  }
}

testPlugin_class.prototype.setDirection = function(callerElem) {
  this.outgoingProjections = (callerElem.options[callerElem.selectedIndex].value == 'out');
  this.retrieveConnectivity(this.acr);
}

testPlugin_class.prototype.retrieveConnectivity = function(originSite) {
  var divElem = document.getElementById('SBA_CONNECTIVITY');
  if (!divElem) return;
  var flnData = [[0,"7.75e-01","1.79e-02",0,0,"5.37e-05",0,"1.81e-05","1.19e-05",0,0,0,0,0,0,0,0,0,0,0,0,0,"1.43e-04",0,0,0,0,"1.90e-02","2.68e-05"],["6.83e-01",0,"4.36e-01","2.43e-02","1.78e-03","3.41e-05","1.23e-04","3.61e-05","7.94e-02",0,0,"3.98e-05","5.28e-06",0,"3.88e-04","1.12e-05","1.75e-04",0,0,0,"9.04e-05",0,"3.49e-03",0,"2.24e-03",0,"1.87e-05","1.19e-01","1.45e-03"],["2.04e-01","1.70e-01",0,"2.56e-01","8.55e-05",0,"1.10e-04","3.01e-03","3.38e-01",0,0,0,"2.64e-06",0,"1.36e-03","2.24e-05","2.74e-02",0,0,0,0,0,"1.21e-02",0,0,"7.73e-06",0,"3.81e-01","3.66e-04"],["2.48e-02","1.09e-03","2.39e-01",0,"7.77e-06",0,0,"2.30e-03","3.38e-04",0,0,0,"5.28e-06",0,"1.66e-04",0,"1.38e-01",0,0,0,"4.52e-05",0,"1.47e-03",0,"1.66e-05",0,0,"3.82e-02",0],[0,0,"7.24e-06","2.57e-05",0,"3.41e-05","3.78e-02","2.27e-03","7.83e-04",0,0,"2.52e-04","9.91e-05","2.04e-04","2.24e-03","4.07e-03",0,"5.11e-03",0,"1.66e-04","2.51e-02",0,"1.03e-02","1.46e-02","6.04e-01","8.70e-02","3.76e-03","5.96e-06","2.16e-02"],[0,0,0,"3.85e-05","6.37e-04",0,"7.03e-03","1.31e-03","1.59e-05","1.42e-01","6.84e-03","3.66e-02",0,0,"1.01e-03",0,"7.52e-06","2.21e-02","9.00e-03","4.19e-02","2.14e-03","3.17e-01","1.27e-02","1.80e-02","4.98e-05","7.73e-06","1.37e-05","2.98e-06","2.98e-05"],[0,"5.73e-05",0,0,"2.22e-01","4.39e-05",0,"1.94e-02","1.90e-03",0,0,"1.86e-04","3.43e-04","4.30e-05","6.88e-03","4.36e-04","2.51e-05","2.77e-05","4.50e-05","2.54e-04","3.86e-02",0,"4.15e-01","3.47e-02","3.16e-02","4.91e-02","2.80e-03","6.28e-04","1.86e-02"],[0,0,"4.28e-05","4.62e-04","7.31e-04","7.32e-05","1.64e-03",0,"1.18e-01","5.69e-06","1.51e-01","3.97e-01","1.88e-04",0,"1.41e-03","2.24e-05","2.02e-03","7.96e-03","3.60e-04","8.33e-03","2.12e-03","1.69e-05","1.51e-03","2.23e-02","5.15e-04","8.88e-04","1.48e-05","4.53e-04","7.85e-02"],["1.85e-04","2.67e-05","4.28e-05","1.17e-03","4.66e-05",0,"2.08e-04","2.05e-02",0,0,0,0,"3.70e-05",0,"1.94e-04","5.59e-05","8.02e-05",0,0,0,0,0,"5.21e-04",0,"2.57e-04","1.04e-04","7.39e-06","1.46e-02","1.34e-02"],[0,0,0,"3.85e-05","4.66e-05","2.03e-01","4.91e-05","1.81e-05",0,0,"3.63e-02","3.08e-03",0,0,"6.92e-05",0,0,"2.24e-03","1.25e-01",0,0,"2.79e-02","2.35e-04","1.81e-03","1.66e-05",0,0,"2.38e-05","1.19e-05"],[0,0,0,"2.57e-05","9.72e-04","9.76e-05","8.58e-05","1.02e-02",0,0,0,"2.18e-02",0,0,"2.77e-05",0,0,"2.56e-02","1.09e-01","1.88e-02","2.26e-05",0,"6.13e-05","7.02e-05",0,0,0,0,"7.11e-03"],[0,0,0,"2.57e-05","1.11e-03","7.72e-02","7.85e-04","5.51e-04",0,"2.03e-03","1.14e-02",0,0,0,"2.21e-04",0,0,"4.32e-03",0,"5.25e-05","5.65e-05","1.06e-03","3.06e-05","1.95e-02",0,0,0,0,"5.96e-06"],["2.00e-05","2.67e-05","2.89e-04","1.31e-03","1.52e-04","3.90e-05","1.47e-03","2.79e-03","7.95e-06",0,0,"1.59e-04",0,"2.21e-02","1.47e-02","6.96e-02","4.29e-04","2.77e-05",0,"4.38e-05","6.58e-03",0,"1.40e-03","2.90e-04","6.14e-04","1.91e-02","4.73e-02","2.43e-04","5.96e-05"],["1.34e-04","1.01e-04","3.85e-04","1.28e-04","6.50e-03","1.95e-05","1.44e-02","4.13e-02","4.77e-05",0,"2.01e-03","7.95e-05","2.33e-01",0,"4.19e-01","2.89e-01","2.51e-05","4.15e-05",0,"4.47e-04","1.17e-02",0,"5.75e-03","7.37e-04","1.32e-02","1.44e-02","1.30e-02","2.17e-04","8.93e-05"],["1.56e-03","8.54e-05","8.55e-05","1.92e-05","2.56e-02","4.88e-06","3.40e-02","1.31e-02","3.62e-04",0,0,"9.89e-03","2.93e-02","2.39e-01",0,"6.18e-02","5.01e-06","1.52e-04","9.00e-05","3.77e-04","1.84e-03",0,"1.21e-02","9.83e-04","4.44e-03","5.41e-05","6.70e-04","1.78e-03","1.17e-02"],[0,0,0,"5.13e-05","5.36e-04","3.90e-05","1.19e-03",0,0,0,0,0,"1.94e-01","3.15e-01","1.99e-02",0,"6.01e-05",0,0,"6.13e-05","2.55e-03",0,"9.81e-04","1.17e-05","4.65e-04","3.52e-04","1.30e-02","1.79e-05","5.96e-06"],["1.29e-03","1.76e-03","7.55e-02","2.31e-01",0,"3.90e-05","4.91e-05","2.72e-03","1.22e-03",0,0,0,"9.27e-04","1.50e-04","7.89e-04",0,0,0,0,0,0,0,"1.43e-04","1.05e-04","6.64e-05",0,"1.37e-05","1.36e-02","5.96e-06"],[0,0,0,0,"3.04e-03","8.51e-03","2.39e-03",0,"2.78e-05","2.39e-04",0,"3.98e-05","2.64e-04","1.40e-04","1.38e-05","1.09e-04",0,0,"4.32e-03","3.12e-02","9.32e-02","2.51e-03","2.42e-03","6.88e-03","3.04e-03","9.37e-02","1.68e-02",0,"1.65e-03"],[0,0,0,0,"5.44e-05","4.30e-03","8.58e-04","1.63e-04",0,"4.32e-04","3.37e-01","9.41e-04","1.06e-05",0,0,0,0,"1.12e-02",0,"1.63e-01","2.94e-04","6.76e-05","1.85e-03","5.85e-05","6.64e-05","7.73e-06","6.23e-06","2.98e-06","3.07e-04"],[0,0,0,"6.41e-06","2.23e-02","1.20e-03","2.16e-02","7.49e-03","1.54e-03",0,"1.18e-01","2.93e-03","1.58e-05",0,0,0,0,"4.91e-02","4.02e-01",0,"9.72e-02","1.13e-05","1.90e-02","5.17e-03","1.33e-04","8.50e-05","6.18e-05","5.96e-06","3.17e-02"],[0,0,0,"4.49e-05","5.54e-02","3.90e-05","1.08e-01","9.03e-05","5.68e-04",0,"3.14e-04",0,"5.02e-05","8.60e-05","7.47e-04","1.31e-04",0,"8.05e-02","3.34e-03","2.43e-02",0,0,"2.61e-02","8.75e-03","7.37e-03","1.51e-01","3.27e-03",0,"1.34e-02"],[0,0,0,"1.28e-05","3.30e-04","4.55e-02","5.76e-04",0,0,"4.24e-02",0,"6.63e-04",0,0,0,"8.39e-06",0,"2.20e-03","3.60e-04","7.88e-05","1.81e-04",0,"1.75e-03","9.21e-03",0,0,0,"2.98e-06",0],["3.19e-04","1.23e-04","1.99e-03","6.08e-03","1.47e-02","8.83e-04","1.85e-01","3.61e-04",0,0,0,0,"4.75e-05",0,"4.84e-04","2.80e-06","4.59e-03","8.31e-05",0,"1.75e-05","3.19e-03",0,0,"3.08e-03","6.64e-05","9.35e-04","5.49e-05","2.28e-03","5.78e-04"],[0,0,"3.21e-05","3.91e-04","1.68e-02","2.84e-03","9.25e-02","3.80e-03",0,"1.04e-02",0,"1.27e-02","5.22e-04",0,0,0,"1.42e-03","7.48e-04",0,"2.54e-04","3.83e-03","2.01e-02","2.49e-02",0,"1.16e-04","1.47e-04","2.40e-05","3.87e-05","1.24e-03"],[0,0,0,"1.28e-05","1.96e-01","9.76e-05","1.12e-01","1.46e-02","7.55e-04","1.14e-05","1.88e-04",0,"9.75e-03","3.62e-03","6.87e-03","4.12e-03","1.50e-05","4.85e-04",0,0,"9.04e-04","1.13e-05","3.91e-02","3.85e-02",0,"3.99e-02","2.41e-01",0,"4.29e-03"],[0,0,0,"1.28e-05","7.10e-02","4.39e-05","1.71e-02","7.52e-03","1.12e-03",0,0,0,"5.81e-04","2.15e-04","8.03e-04","8.98e-04",0,"4.29e-02","3.60e-04","1.31e-04","1.03e-01",0,"2.06e-02","1.65e-02","3.92e-02",0,"1.96e-02",0,"3.84e-02"],[0,0,0,0,"7.89e-03","9.27e-05","2.11e-03",0,0,0,0,0,"3.23e-02","2.40e-02","1.43e-03","8.73e-03",0,"1.52e-04",0,0,"1.49e-03",0,"5.31e-04","2.40e-04","7.51e-02","1.32e-01",0,0,0],["5.20e-02","2.99e-02","1.02e-01","2.44e-02","2.25e-04",0,"6.87e-04","5.42e-05","1.62e-01",0,0,"1.70e-03","1.32e-05","4.30e-05","7.20e-04",0,"1.50e-05",0,0,"8.76e-06",0,0,"2.03e-02",0,"1.66e-05",0,0,0,"9.14e-04"],[0,0,0,"5.13e-05","3.45e-02","4.88e-06","5.15e-04","2.11e-02","2.35e-04",0,"1.82e-03","1.86e-02",0,0,"4.15e-05","2.13e-04",0,"1.95e-02",0,"7.47e-03","5.63e-03",0,"1.02e-04","7.78e-04","7.47e-04","2.65e-03",0,0,0],["9.48e-03","1.04e-02","1.49e-02","1.23e-01","4.66e-05","4.88e-06","4.91e-05",0,"5.04e-03",0,0,0,0,0,0,0,"1.90e-04",0,0,0,0,0,"5.42e-03","1.17e-05","1.16e-04",0,0,"5.10e-02","1.79e-05"],["1.34e-03","9.24e-04","1.50e-04","4.94e-04",0,0,"1.23e-05","3.61e-05","3.20e-02",0,0,0,0,0,"2.77e-05",0,"3.51e-04",0,0,0,0,0,"4.29e-04",0,0,0,0,"3.35e-02","1.73e-04"],["6.99e-04","1.86e-03","4.02e-03","5.87e-03",0,0,"1.47e-04",0,"7.91e-03",0,0,0,0,"3.22e-05",0,0,"5.76e-05",0,0,0,0,0,"3.06e-04",0,0,0,0,"7.71e-02",0],["1.91e-03","4.97e-04","1.63e-03","7.90e-03","2.43e-03","5.66e-03","6.28e-03","1.29e-01","2.02e-02","1.57e-03","2.95e-03","5.78e-02","1.20e-04","4.30e-05","2.79e-02","8.39e-06","2.83e-03","2.22e-04",0,"7.01e-05","4.41e-04","6.08e-04","2.92e-02","1.61e-02","3.32e-05","5.72e-04","3.43e-06","2.29e-02","3.11e-02"],["2.26e-03","4.43e-04","8.55e-04","1.71e-03","1.55e-05",0,"3.68e-05","3.16e-04","3.71e-02",0,0,0,0,0,"4.79e-03",0,"1.10e-04",0,0,0,0,0,"3.15e-03",0,0,0,"8.17e-05","9.32e-03","4.77e-03"],["3.29e-04","3.10e-04","7.70e-04","4.55e-03","4.59e-04",0,"4.16e-03","1.07e-02","8.98e-04",0,0,"5.44e-04","3.33e-02","4.30e-03","1.17e-02","2.42e-03","4.44e-04",0,0,"1.23e-04","2.86e-03","2.25e-05","4.89e-03","5.33e-03","2.97e-03","3.97e-03","1.27e-03","6.07e-03","6.25e-04"],["1.44e-04","1.07e-04","1.92e-03","5.59e-03",0,0,"9.81e-05","2.35e-03","7.79e-04",0,0,0,"2.09e-02","1.16e-03","6.04e-03","6.43e-05","6.35e-03","2.77e-05",0,"5.25e-05","2.98e-03",0,"2.02e-03","8.97e-03",0,"7.11e-04","4.12e-05","1.33e-03","1.37e-04"],["6.74e-03","1.58e-03","1.46e-02","6.98e-02","2.88e-04",0,"2.78e-03","8.66e-03","1.04e-02",0,0,0,"2.26e-03",0,"6.09e-03","1.01e-04","1.05e-03",0,0,0,"7.91e-05",0,"3.31e-03","2.34e-05",0,"2.20e-04","2.16e-04","6.19e-02","5.36e-05"],["1.91e-03","2.46e-04","8.55e-05","5.84e-04","1.96e-03",0,"2.10e-03","1.26e-01","5.18e-02",0,"3.14e-04","1.30e-02","1.83e-02","7.11e-02","1.81e-01","1.09e-04","1.00e-05","1.66e-04","1.91e-04","4.03e-04","6.33e-04",0,"5.40e-03","5.73e-04","1.66e-05",0,"2.06e-05","5.74e-03","7.99e-02"],["3.60e-04","8.54e-04","1.04e-02","4.03e-02",0,"1.46e-05","2.45e-05","2.29e-03","7.87e-03",0,0,0,"2.06e-04",0,"3.05e-04",0,"1.74e-02",0,0,0,0,0,"2.63e-03","2.34e-05","1.66e-05",0,0,"8.84e-02",0],["6.17e-04","4.27e-04","6.62e-03","1.75e-02","7.77e-06","7.32e-05","2.45e-05","3.88e-03","5.56e-05","8.07e-04","1.26e-04","7.95e-05","9.93e-03","8.60e-05","6.51e-04","1.18e-03","3.51e-02",0,0,"3.50e-05","5.65e-05","1.25e-03","1.33e-04","2.19e-03","3.32e-05","3.48e-05","1.79e-04","8.87e-04","1.79e-04"],["5.14e-05","4.27e-04","3.75e-03","8.81e-03","1.55e-05",0,0,0,"3.18e-05",0,0,0,"6.44e-04",0,"7.47e-04",0,"2.69e-01",0,0,0,0,0,"3.06e-05","2.34e-04",0,"1.55e-05","1.37e-05","1.06e-03",0],["4.52e-04","6.25e-04","2.74e-03","1.56e-02","7.77e-06","1.17e-04",0,"9.03e-05","4.77e-05","1.42e-04",0,0,"1.37e-02","1.72e-04","3.88e-04",0,"1.15e-01",0,0,0,"6.78e-05","3.83e-04","1.33e-04","4.33e-04",0,0,"4.81e-05","1.16e-03",0],["2.20e-03","1.16e-03","3.74e-02","9.08e-02",0,"9.76e-05","1.23e-05","7.74e-02","2.70e-02",0,0,"5.30e-05","1.61e-03",0,"1.40e-03",0,"3.90e-02","2.77e-05",0,0,0,0,"1.28e-03","7.02e-04","3.74e-05",0,"2.06e-05","1.89e-02","5.81e-04"],["2.26e-04","1.55e-04","3.81e-03","1.57e-02","1.17e-05","6.83e-05","3.68e-05","3.88e-04","3.70e-04","6.82e-05","2.51e-04","3.05e-04","4.48e-02","8.60e-05","5.12e-04",0,"6.52e-02",0,0,"5.25e-05","9.15e-04","1.15e-03","1.33e-04","1.14e-02",0,"9.27e-05","4.94e-04","2.27e-03",0],["2.48e-03","1.01e-04","9.58e-03","2.95e-02","7.77e-06","3.90e-05","1.35e-04","4.39e-03","2.15e-04",0,0,0,"3.94e-03","4.08e-04","3.74e-04",0,"2.44e-01",0,0,0,"2.26e-05",0,"9.19e-05","2.03e-02",0,"3.09e-05","4.12e-05","1.51e-02","1.79e-05"],["1.37e-03","1.15e-03","1.34e-02","1.46e-02",0,"9.76e-06","1.23e-05","8.31e-04","1.80e-02",0,0,"1.59e-04","1.50e-02","6.45e-04","9.14e-03","2.49e-02","1.62e-02",0,0,0,0,0,"1.27e-03","6.14e-05","8.30e-05","2.97e-04","3.30e-04","9.41e-03","5.84e-04"],["5.49e-05","1.60e-05",0,"3.85e-05","2.25e-04","3.90e-05","1.74e-03","4.52e-05",0,"9.10e-05","3.77e-04","5.04e-04","1.63e-02","1.16e-02","2.38e-02","9.18e-02","5.01e-06",0,"3.15e-04","3.07e-04","1.58e-03","2.25e-05","2.02e-03","3.51e-05",0,"3.86e-05","2.61e-04","8.04e-05","3.10e-04"],["1.10e-04",0,"2.14e-05","1.28e-05","7.00e-05","4.88e-05","1.17e-03","1.81e-05",0,"1.71e-05",0,"1.44e-03","7.07e-03","7.28e-02","5.58e-02","4.88e-02","1.50e-05","2.77e-05",0,0,0,0,"4.49e-04",0,0,"2.70e-05","4.60e-04","2.98e-06","3.33e-04"],["2.06e-05","5.34e-06",0,"7.70e-05","2.02e-03",0,"5.19e-03",0,"1.43e-04",0,0,"5.30e-05","8.54e-03","5.44e-02","9.00e-02","9.70e-02",0,0,0,0,"2.26e-05",0,"2.00e-03","2.05e-05","1.83e-04",0,"5.77e-04",0,"9.71e-04"],["8.89e-06",0,"1.38e-04","5.39e-04","5.87e-02","2.59e-04","7.09e-02",0,"4.41e-04",0,0,0,"5.81e-05",0,"6.78e-04","5.59e-06","1.92e-03","2.77e-05",0,"2.63e-05","2.30e-03",0,"1.23e-01","1.93e-03","4.24e-03","5.83e-04","1.06e-03","8.04e-05","3.68e-03"],["5.49e-05",0,0,0,"1.55e-05","5.37e-05","7.11e-04",0,0,0,0,0,"9.61e-04","1.90e-02","1.30e-02","8.21e-02","7.52e-06","2.77e-05",0,0,0,0,"6.95e-04",0,0,"1.55e-05","3.43e-05",0,0],["3.30e-04",0,0,0,"8.32e-04","3.41e-05","5.76e-04",0,0,"2.06e-03","1.02e-01","1.52e-01",0,0,"8.03e-04",0,0,"3.49e-03","6.60e-03","1.24e-02","3.84e-04","5.07e-05","1.12e-04","4.27e-04","1.66e-05",0,"4.08e-05",0,"5.42e-04"],["1.10e-04","2.79e-06",0,0,"8.39e-04",0,"8.58e-05","1.64e-01","9.54e-05",0,"6.21e-03","1.28e-02","1.32e-05","8.60e-05","4.48e-02","7.38e-04",0,0,0,"1.35e-02","1.74e-03",0,"4.29e-04","2.19e-03",0,0,0,"2.68e-05","3.70e-03"],[0,"5.87e-05",0,0,"7.62e-04",0,"7.48e-04","8.13e-05","9.14e-04","5.69e-06","1.68e-02","6.06e-02",0,0,"5.54e-05",0,0,"1.38e-04",0,"7.88e-05","1.13e-05",0,"1.63e-03","3.51e-05","1.66e-05",0,0,"1.49e-03","8.38e-03"],[0,"2.14e-05",0,0,"1.93e-02","1.46e-05","5.89e-04","7.83e-02","3.88e-02",0,0,"1.38e-03",0,0,"1.38e-05",0,0,"8.06e-03",0,0,0,0,"2.15e-04","8.19e-05","7.47e-05",0,0,"2.98e-06","4.34e-01"],[0,"1.60e-05",0,0,"9.64e-04","9.76e-06",0,"1.26e-04","2.02e-02",0,0,0,0,0,0,0,0,"1.38e-04",0,0,0,0,0,0,0,0,0,0,"2.32e-03"],[0,0,"6.42e-05","2.57e-05",0,"1.17e-04","6.13e-05","4.45e-03","4.61e-04","1.44e-03","3.77e-04",0,"3.86e-03",0,"5.81e-04","7.84e-03","3.43e-04",0,0,0,0,"2.25e-03","2.86e-04","2.34e-05","1.66e-05","1.55e-04","1.37e-04",0,"4.17e-05"],[0,0,"5.35e-05","1.28e-04","1.97e-03","6.56e-03","3.00e-03","1.27e-03","3.97e-06","3.00e-02","9.23e-03","1.46e-02","9.51e-04","6.23e-04","1.96e-02","1.31e-03","7.77e-05","1.75e-02","2.66e-03","6.48e-03","2.46e-03","2.50e-02","9.21e-03","1.01e-02","1.66e-05","1.00e-04","4.74e-04","4.47e-05","1.55e-04"],[0,0,"4.28e-05","4.17e-04","4.24e-03","1.37e-04","1.24e-01","1.35e-04","6.76e-04",0,0,"3.45e-04","7.82e-04",0,"7.47e-04","5.03e-05","6.49e-03","8.31e-05",0,"4.38e-05","6.39e-03",0,"6.82e-02","7.63e-03",0,"4.79e-04","1.32e-03","5.00e-04","1.13e-04"],[0,0,0,"1.92e-05","1.63e-04","4.88e-06","1.23e-05","3.61e-05","6.49e-03",0,"1.63e-03","7.14e-02",0,0,0,0,0,"8.24e-03",0,"2.21e-03",0,0,"8.17e-05",0,"1.66e-05",0,"1.02e-05","1.19e-05","2.74e-02"],[0,0,0,"2.89e-04","1.17e-04","4.88e-05","1.47e-04","3.79e-04",0,"4.83e-04","2.51e-04",0,"2.22e-01","1.30e-01","3.77e-03","1.40e-01","1.17e-03",0,0,"2.63e-05","5.99e-04","2.16e-03","5.01e-04","7.26e-04","1.66e-05","8.99e-03","3.04e-02","2.38e-05",0],[0,0,0,"4.49e-05","1.32e-04","2.44e-05","1.47e-04",0,0,0,0,0,"5.27e-03","8.81e-04","2.15e-04","7.58e-03","5.01e-06",0,0,"9.63e-05","5.65e-04",0,"3.27e-04","2.34e-05","3.32e-05","6.18e-05","3.43e-04",0,0],[0,0,0,"2.57e-05",0,"2.48e-03",0,0,0,"9.26e-03","2.51e-03",0,0,0,0,0,0,"2.77e-05","1.22e-03",0,"1.13e-05","2.25e-05",0,0,0,0,0,"2.98e-06","1.55e-04"],[0,0,0,"1.22e-04",0,"1.05e-02","2.45e-05",0,0,"2.40e-01","3.21e-02",0,0,0,0,0,"5.01e-06","5.26e-04","9.93e-03","5.80e-03","1.13e-04","1.13e-04","2.45e-04","3.51e-05","2.91e-05",0,0,0,"2.98e-05"],[0,0,0,"1.28e-05","8.22e-03","1.46e-04","2.58e-04","9.21e-02","2.02e-03",0,"8.86e-02","5.46e-03","5.48e-04","4.62e-04","3.09e-03","1.26e-02","7.52e-06","2.40e-02","3.21e-02","8.35e-02","3.04e-02",0,"7.56e-04","1.18e-02","1.38e-02","6.53e-03","2.77e-03","1.13e-04","9.12e-02"],[0,0,0,"7.70e-05","6.30e-04","7.56e-04","7.11e-04","9.03e-05",0,0,"6.28e-05",0,"8.45e-04",0,0,"1.23e-03","2.71e-04","4.36e-03",0,"3.15e-04","1.08e-02","2.13e-03","4.17e-03","1.63e-02","1.83e-04","2.54e-03","4.33e-04","1.04e-05","1.10e-03"],[0,0,0,"3.85e-05","5.17e-04","1.32e-04","1.02e-03","5.87e-03","9.06e-04","5.69e-05","1.26e-02","1.91e-03","1.29e-03",0,"4.57e-04","1.03e-03","3.51e-05","1.18e-01","4.24e-03","2.13e-02","6.48e-02","3.94e-05","2.32e-03","2.77e-03","3.32e-05","8.14e-03","4.41e-03","4.47e-06","1.01e-02"],[0,0,0,"1.92e-05","5.52e-04","5.02e-04","3.68e-04",0,0,"7.96e-05","6.03e-03","1.67e-03",0,"4.30e-05",0,"2.24e-05",0,"1.02e-01","2.08e-02","1.35e-01","1.78e-02","1.18e-04","1.05e-03","1.14e-03","1.66e-05","1.39e-04","1.37e-05",0,"9.13e-03"],[0,0,0,"3.85e-05","9.69e-02","1.12e-04","3.37e-02","1.45e-04","8.35e-05",0,0,"6.76e-04","8.70e-03","2.47e-03","2.99e-03","8.53e-04","4.09e-04","2.31e-03",0,"4.55e-04","1.48e-02","3.15e-04","1.11e-02","3.01e-01","5.84e-02","3.92e-02","2.95e-02",0,"5.78e-03"],[0,0,0,"1.92e-05","2.01e-02","2.93e-05","2.63e-02","1.35e-03","1.59e-05",0,0,0,"2.11e-03","3.87e-04","1.38e-05","3.69e-04","9.42e-04",0,0,0,"3.47e-02",0,"1.25e-02","5.70e-02","1.44e-03","2.78e-04","3.24e-03","2.98e-06",0],[0,0,0,"1.28e-05","9.49e-03","2.86e-03","1.58e-02",0,0,"5.69e-04",0,"2.72e-03","1.11e-04",0,0,0,"2.76e-05","1.60e-02","4.05e-04","6.83e-04","1.03e-02","1.13e-02","1.93e-02","8.16e-02","8.30e-05","5.41e-05","5.49e-05",0,"1.67e-04"],[0,0,0,"1.28e-05","2.57e-04","1.51e-04","1.84e-04",0,0,0,0,0,"4.53e-03","3.22e-04",0,"6.82e-04","3.51e-05","4.15e-05",0,0,"2.71e-04","5.63e-05","5.41e-04","6.02e-02","2.63e-03","1.27e-02","5.91e-03",0,"2.98e-05"],[0,0,0,"2.37e-04","7.20e-03","1.22e-02","7.14e-03","6.32e-05","3.97e-06","6.17e-03","1.26e-04","1.01e-03","1.70e-02","6.07e-03","4.08e-03","7.80e-03","1.82e-03","2.08e-02",0,"1.23e-04","1.24e-02","1.33e-01","2.12e-02","9.71e-02","3.54e-03","2.24e-02","6.11e-02",0,"4.17e-05"],[0,0,0,0,"2.10e-04",0,0,0,"2.31e-04",0,0,0,"9.64e-05","7.52e-05","1.94e-04","6.21e-03","5.01e-05",0,0,0,0,0,0,0,0,0,"4.67e-04","8.93e-06","1.61e-04"],[0,0,0,0,"2.33e-05","1.04e-02","9.81e-05",0,0,"7.76e-03",0,0,"5.28e-06","4.30e-05",0,0,0,0,0,0,0,"1.61e-01","1.32e-03","1.52e-04",0,0,0,0,0],[0,0,0,0,"1.05e-04","5.88e-02","8.95e-04",0,0,"3.80e-01",0,"5.32e-02",0,0,0,0,"4.94e-04","2.80e-03",0,"5.25e-05","2.26e-05","2.47e-01","1.31e-03","2.26e-02",0,"7.73e-06",0,"2.98e-06",0],[0,0,0,0,"5.44e-03","1.46e-05","1.23e-04","3.64e-02","3.97e-04",0,"2.95e-03",0,"1.91e-04","4.30e-05","3.32e-04","7.86e-03",0,"4.15e-05","4.50e-05",0,0,0,"2.45e-04","6.85e-03","2.47e-03","5.37e-04","1.35e-03","1.79e-05","5.65e-03"],[0,0,0,0,"2.73e-02",0,"3.68e-05","7.33e-02","2.15e-03","2.84e-05","2.01e-03",0,0,0,"1.74e-03","1.79e-03",0,"3.18e-04",0,"1.05e-04","4.84e-03",0,"7.15e-05","3.51e-05","1.01e-03","7.07e-04","2.06e-04",0,"2.68e-02"],[0,0,0,0,"3.11e-05","3.90e-05","2.94e-04",0,0,0,0,0,"1.56e-03","3.44e-04",0,"2.60e-03",0,"1.94e-03",0,0,"2.49e-04",0,"1.02e-04","9.07e-05","1.59e-03","3.40e-02","8.12e-02","2.98e-06","3.57e-05"],[0,0,0,0,"3.58e-04","3.14e-02","2.33e-04","4.97e-04",0,"5.74e-04","4.46e-02","1.17e-03",0,0,0,0,0,"1.15e-01","2.30e-01","3.40e-01","1.01e-02","1.57e-03","2.25e-04","1.24e-03","1.66e-05",0,"6.87e-06",0,"1.67e-03"],[0,0,0,0,"9.66e-03","3.41e-05","1.28e-03",0,0,0,"3.52e-03",0,0,"8.60e-05","1.38e-05","2.24e-05","1.50e-05","2.62e-01","7.80e-03","7.54e-02","2.42e-01",0,"2.33e-03","9.18e-03","3.32e-03","6.55e-02","8.93e-05",0,"1.90e-03"],[0,0,0,0,"8.89e-03","5.00e-01","3.86e-02",0,"1.59e-05","1.11e-01",0,"1.19e-02","5.28e-06",0,0,0,0,"3.07e-03","2.94e-02","4.23e-03","2.72e-03","3.26e-03","5.42e-03","1.47e-02","3.32e-05","3.09e-05","6.87e-06","2.08e-05",0],[0,0,0,0,"2.44e-02","4.88e-05","2.16e-03","5.42e-05","1.59e-05",0,0,0,"1.66e-03","4.73e-04","2.77e-05","1.23e-03",0,"1.33e-02","4.50e-05",0,"1.16e-01","2.25e-05","2.57e-03","5.47e-04","1.17e-01","1.76e-01","1.55e-01",0,"4.82e-04"],[0,0,0,0,"1.30e-03","7.96e-03","2.21e-04",0,0,"7.63e-03",0,0,"6.40e-03","4.30e-04",0,"3.83e-03","8.02e-05","6.37e-04",0,"2.45e-04","1.21e-03","2.82e-02","4.41e-03","6.66e-03","4.82e-04","5.41e-03","2.79e-02","2.98e-06",0],[0,0,0,0,"3.11e-05","2.93e-04","6.13e-05",0,0,"2.10e-04",0,0,"2.98e-04",0,0,"2.50e-03","1.00e-05",0,0,0,0,"4.07e-03","5.82e-04","2.93e-04",0,"2.63e-04","4.94e-04",0,0],[0,0,0,0,"5.44e-05","1.46e-05","9.81e-05",0,0,0,0,0,"1.26e-02","1.36e-02",0,"1.34e-04",0,0,0,0,"2.26e-05",0,"6.13e-05","4.68e-04","2.23e-03","5.54e-03","1.97e-01",0,"2.08e-05"],[0,0,0,0,"7.00e-04","1.17e-04","3.13e-03","1.81e-05",0,"1.76e-04",0,0,"1.61e-03","2.15e-04","2.22e-03","2.98e-03","3.41e-04",0,0,"7.01e-05","2.67e-03","1.66e-03","3.64e-03","1.48e-02","5.65e-04","1.12e-02","1.09e-02",0,"2.38e-05"],[0,0,0,0,0,"3.37e-03","9.20e-04",0,0,"2.44e-03","1.00e-03","2.68e-02",0,0,0,0,0,0,0,"5.25e-05",0,"4.34e-03","1.02e-04","2.07e-03",0,0,0,0,"3.13e-04"],[0,0,0,0,0,"2.93e-05",0,0,"7.95e-06",0,0,0,"9.83e-04",0,"3.53e-04","2.80e-05",0,0,0,0,0,0,"2.04e-05",0,0,0,"7.55e-05","2.98e-06",0],[0,0,0,0,0,"4.88e-06",0,0,0,0,0,0,"6.88e-03","2.71e-03",0,"1.09e-03",0,0,0,0,0,0,"5.11e-05",0,0,"1.55e-04","1.89e-02",0,"2.38e-05"],[0,0,0,0,0,0,0,0,0,"2.27e-05",0,0,"7.40e-05",0,0,"2.85e-04","8.02e-05",0,0,0,0,0,"9.19e-05",0,0,"4.02e-04",0,0,0]];
  var region2id = {"V1":0,"V2":1,"V4":2,"TEO":3,"9-46d":4,"F5":5,"8m":6,"7A":7,"DP":8,"2":9,"5":10,"7B":11,"STPr":12,"STPi":13,"STPc":14,"PBr":15,"TEpd":16,"24c":17,"F1":18,"F2":19,"F7":20,"ProM":21,"8l":22,"9-46v":23,"46d":24,"8B":25,"10":26,"MT":27,"7m":28,"V3":29,"V3A":30,"V4t":31,"LIP":32,"PIP":33,"PGa":34,"IPa":35,"FST":36,"MST":37,"TEOm":38,"PERI":39,"TEad":40,"TEav":41,"TEpv":42,"TEam-a":43,"TEam-p":44,"TH-TF":45,"MB":46,"LB":47,"PBc":48,"8r":49,"Core":50,"7op":51,"TPt":52,"VIP":53,"V6A":54,"V6":55,"ENTO":56,"INS":57,"45B":58,"MIP":59,"POLE":60,"Pi":61,"1":62,"3":63,"23":64,"24a":65,"24b":66,"24d":67,"46v":68,"45A":69,"44":70,"11":71,"12":72,"ProStr":73,"Gu":74,"SII":75,"29-30":76,"31":77,"32":78,"F3":79,"F6":80,"F4":81,"9":82,"OPRO":83,"OPAI":84,"14":85,"13":86,"AIP":87,"SUB":88,"25":89,"PIR":90};
  var region2cluster = {"V1":11,"V2":11,"V4":11,"TEO":6,"9-46d":8,"F5":5,"8m":7,"7A":10,"DP":4,"2":5,"5":1,"7B":1,"STPr":9,"STPi":9,"STPc":10,"PBr":9,"TEpd":6,"24c":1,"F1":5,"F2":1,"F7":8,"ProM":5,"8l":10,"9/46v":8,"46d":9,"8B":9,"10":9,"MT":6,"7m":8,"V3":11,"V3A":11,"V4t":11,"LIP":10,"PIP":6,"PGa":10,"IPa":3,"FST":3,"MST":10,"TEOm":6,"PERI":4,"TEad":11,"TEav":3,"TEpv":6,"TEa/ma":4,"TEa/mp":6,"TH/TF":3,"MB":8,"LB":2,"PBc":9,"8r":10,"Core":2,"7op":1,"TPt":12,"VIP":12,"V6A":12,"V6":12,"ENTO":9,"INS":8,"45B":10,"MIP":12,"POLE":9,"Pi":2,"1":5,"3":5,"23":8,"24a":7,"24b":8,"24d":1,"46v":7,"45A":9,"44":1,"11":9,"12":7,"Pro.St.":2,"Gu":5,"SII":5,"29/30":9,"31":8,"32":9,"F3":1,"F6":1,"F4":5,"9":9,"OPRO":7,"OPAI":5,"14":2,"13":9,"AIP":5,"SUB":2,"25":2,"PIR":2};
  var id0 = region2id[originSite];
  var A = [];
  if (id0 != undefined) {
    var markers = [];
    var nObserved = 0;
    var origSlice_xy = sbaViewer.regionCenter(originSite);
    if (origSlice_xy != undefined) {
      var mk = new sbaMarker_class(originSite,origSlice_xy[0],origSlice_xy[1]);
      mk.rgb = "#FFF";
      markers.push(mk);
    }
    var colorMap = ["#0000AA","#0000FF","#0055FF","#00AAFF","#00FFFF","#55FFAA","#AAFF55","#FFFF00","#FFAA00","#FF5500","#FF0000","#AA0000"];
    for (var acr in region2id) {
      var id = region2id[acr];
      var cluster = region2cluster[acr];
      var fln = (this.outgoingProjections ? flnData[id0][id] : flnData[id][id0]);
      if (fln != undefined) { 
        //a.push('<tr><td>'+acr+'</td><td>'+fln+'</td></tr>');
        A.push([acr,fln]);
        if (fln>0) {
          // marker
          var origSlice_xy = sbaViewer.regionCenter(acr);
          if (origSlice_xy != undefined) {
            var mk = new testMarker_class(acr,origSlice_xy[0],origSlice_xy[1]);
            mk.rgb = colorMap[cluster];
            mk.tooltip = ACR_TO_FULL[acr];
            markers.push(mk);
          } else {
            globalErrorConsole.addError('No center coordinates found for region "'+acr+'"');
          }
        }
        nObserved++;
      }
    }
    sbaViewer.addMarkers(markers,1);
  }
  A.sort(function(a,b) { var ans = Number(b[1])-Number(a[1]); return ans ? ans : a[0].localeCompare(b[0]); });
  for (k in A) A[k] = '<tr><td>'+A[k][0]+'</td><td>'+A[k][1]+'</td></tr>';

  var notice = (nObserved<flnData.length ?
    '<span style="color:#B00">Notice: '+nObserved+' out of '+flnData.length+' possible connections are measured.</span><br/>' : ''
  );
  divElem.innerHTML = notice+'Select a region or click a marker to retrieve its connectivity.<table class="fancy"><tr><th>Region</th><th>FLNe</th></tr>'+A.join('')+'</table>';
}
